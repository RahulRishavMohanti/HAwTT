<html>

<head>
	<title>
		HAwTT
	</title>
   <script src="jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script src="http://www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.js"
  type="text/javascript"></script>
  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css">
  <style type="text/css">
    @import url("http://www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.css");
    h1, h2, h3, h4, h5, h6, p, blockquote, pre,
    abbr, address, cite, code,
    del, dfn, em, img, ins, kbd, q, samp,
    small, strong, sub, sup, var,
    b, i,
    dl, dt, dd, ol,
    fieldset, label, legend,
    table, caption, tbody, tfoot, thead,
    article, a, canvas, details, figcaption, figure,
    footer, header, hgroup, menu, nav, section, summary,
    time, mark, audio, video {
        margin:0;
        padding:0;
        border:0;
        outline:0;
        font-size:100%;
        vertical-align:baseline;
        background:transparent;
    }

    body {
      z-index: 0;
      position: relative;
      background-repeat: no-repeat;
        background-size: cover;
        background-color:black;
        line-height:1;
    }

    article,aside,details,figcaption,figure,
    footer,header,hgroup,menu,nav,section {
        display:block;
    }

    nav ul {
        list-style:none;
    }

    blockquote, q {
        quotes:none;
    }

    blockquote:before, blockquote:after,
    q:before, q:after {
        content:'';
        content:none;
    }

    a {
        margin:0;
        padding:0;
        font-size:100%;
        vertical-align:baseline;
        background:transparent;
    }

    /* change colours to suit your needs */
    ins {
        background-color:#ff9;
        color:#000;
        text-decoration:none;
    }

    /* change colours to suit your needs */
    mark {
        background-color:#ff9;
        color:#000;
        font-style:italic;
        font-weight:bold;
    }

    del {
        text-decoration: line-through;
    }

    abbr[title], dfn[title] {
        border-bottom:1px dotted;
        cursor:help;
    }

    table {color:white;
      font-size: 25px;
      height:auto;
      width: 90%;
      border:solid 1px;
      border-color:white;
      border-collapse: collapse;
      z-index: 12;
      margin-left: -400px;}
      td{
        width:25%;
        border:solid 1px;
      border-color:white;
      }


    /* change border colour to suit your needs */
    hr {
        display:block;
        height:1px;
        border:0;
        border-top:1px solid #cccccc;
        margin:1em 0;
        padding:0;
    }

    input, select {
        vertical-align:middle;
    }
    @font-face {
        font-family: myFirst;
        src: url("advent-pro/AdventPro-ExtraLight.ttf");
    }
    body{
    	background-color: black;
    	background-size: cover;
    	background-repeat: no-repeat;
    	position: absolute;
    }
    .topbar{
    	text-align: right;
      position: fixed;
    	width:100%;
      margin-right: 5px;
      font-family:myFirst;
    	font-size:50px;
    	color:white;
    }
    .graph
    { top: 20%;
      right: 0%;
      width:30%;
      height:auto%;
      background-color: transparent;
      opacity: 0.7;
      position: fixed;
    }
    .a1{
    	font-family: myFirst;
    	margin-left: 40%;
    	margin-top: 5% ;
    	text-shadow:0 0 0.2em darkblue;
    	font-size: 60px;
      width: 100%;
    	color:white;
      position: fixed;
      cursor:pointer;
    }
    .a1:hover{
    	text-shadow:0 0 0.5em lime;
    }
    .div1{
      height:10%;
      width:30%;
      left:0%;
      margin-top:20%;
     position:fixed;
    }

    //todo
    /* Remove margins and padding from the list */
    ul {
      width:100%;
      position: relative;
      margin-left:32vw;
      padding: 0;
    }


    /* Style the list items */
    ul li {
    	margin-left:0vw;
    	width: 100%;
      cursor: pointer;
      position: relative;
      padding: 12px 8px 12px 40px;
      background: #eee;
      font-size: 18px;
      transition: 0.2s;

      /* make the list items unselectable */
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    /* Set all odd list items to a different color (zebra-stripes) */
    ul li:nth-child(odd) {
      background-color:grey 0.5;
      color:Black;
      font-family: Avenir;
      font-size: 25px;
      opacity: 0.6;
    }
    ul li:nth-child(even) {
      color:black;
      font-family: Avenir;
      font-size: 25px;
      opacity: 1;
    }
    /* Darker background-color on hover */
    ul li:hover {
      background-color:darkblue;
      color:white;
      opacity: 0.5
      }

    /* When clicked on, add a background color and strike out text */
    ul li.checked {
      background: #888;
      color: #fff;
      text-decoration: line-through;
    }

    /* Add a "checked" mark when clicked on */
    ul li.checked::before {
      content: '';
      position: absolute;
      border-color: #fff;
      border-style: solid;
      border-width: 0 2px 2px 0;
      top: 10px;

      transform: rotate(45deg);
      height: 15px;
      width: 7px;
    }

    /* Style the close button */
    .close {
      position: absolute;
      right: 0;
      top: 0;
      padding: 12px 16px 12px 16px
    }

    .close:hover {
      background-color: #f44336;
      color: white;
    }

    /* Style the header */
    .header {
      padding: 30px 40px;
      color: white;
      margin-left: 1vw;
      margin-top: 50%;
      width: 70%;
      text-align: center;
    }

    /* Clear floats after the header */
    .header:after {
      content: "";
      display: table;
      clear: both;
    }

    /* Style the input */
    .b1{
      border:none;
      height:100%;
      width: 100%;
      color:white;
      cursor: pointer;
      font-size: 25px;
    }
    .b1:hover{
      background-color: grey;
    }
    .b1:active{
      background-color: teal;
      opacity: 0.5;
    }
    input {border:none;
      border-bottom: solid 3px;
      border-color:white;
      background-color:transparent;
      width: 100%;
      padding: 10px;
      float: left;
      height:80%;
      font-size: 16px;
      color:white;
      font-family: Avenir;
      font-size: 25px;
    }
    .n{border:none;
        border-bottom: none 3px;
      border-color:none;
      background-color:transparent;
      background-color:transparent;
      width: 100%;
      padding: auto;
      float: none;
      height:100%;
      font-size: 16px;
      color:white;
      opacity: 0.5;
      font-family: Avenir;
      font-size: 40px;
    }
    input:focus{
    	border-color:lightblue;
    	background-color: black 0.5;
    }

    /* Style the "Add" button */
    .addBtn {
      padding: 9.5px;
      width: 25%;
      font-family: Avenir;
      font-size: 25px;
      color:white;
      background: transparent;
      border:solid 3px;
      border-color:white;
      height: 32px;
      float: left;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn{
      display: none;
    }
    .addBtn:hover {
      border-color:lightblue ;
      opacity: 0.8;
    	background-color:aqua;
      color:white;
    	}
    .bottombar{
        color:white;
        background-color: black;
        opacity:0.7;
        position: fixed;
        left: 0%;
        bottom: 0;
        height:1%;
        padding:20px;
        padding-top: 15px;
        width:100%;
        font-family: Avenir Next Condensed;
         box-shadow: 10px 10px 10px 10px black;
    }
    .assistant{
    	margin-top:10vw;
      padding-top: 5%;
      position: absolute;
      z-index:10;
      font-family: Avenir;
      color:white;
      font-size: 50px;
      background-color:transparent;
      width:50%;
      font-size: 20px;
      height:10%;
      margin-left:0%;
    	padding-left:5%;
      transition:0.5s;

    }
    span{
      cursor:pointer;
    }
    /* The snackbar - position it at the bottom and in the middle of the screen */
    #snackbar {
        visibility: visible; /* Hidden by default. Visible on click */
        min-width: 250px; /* Set a default minimum width */
        margin-left: -125px; /* Divide value of min-width by 2 */
        background-color: #333; /* Black background color */
        color: #fff; /* White text color */
        text-align: center; /* Centered text */
        border-radius: 2px; /* Rounded borders */
        padding: 16px; /* Padding */
        position: fixed; /* Sit on top of the screen */
        z-index: 1; /* Add a z-index if needed */
        left: 50%; /* Center the snackbar */
        bottom: 30px; /* 30px from the bottom */
    }

    /* Show the snackbar when clicking on a button (class added with JavaScript) */
    #snackbar.show {
        visibility: visible; /* Show the snackbar */

    /* Add animation: Take 0.5 seconds to fade in and out the snackbar.
    However, delay the fade out process for 2.5 seconds */
        -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
        animation: fadein 0.5s, fadeout 0.5s 2.5s;
    }

    /* Animations to fade the snackbar in and out */
    @-webkit-keyframes fadein {
        from {bottom: 0; opacity: 0;}
        to {bottom: 30px; opacity: 1;}
    }

    @keyframes fadein {
        from {bottom: 0; opacity: 0;}
        to {bottom: 30px; opacity: 1;}
    }

    @-webkit-keyframes fadeout {
        from {bottom: 30px; opacity: 1;}
        to {bottom: 0; opacity: 0;}
    }

    @keyframes fadeout {
        from {bottom: 30px; opacity: 1;}
        to {bottom: 0; opacity: 0;}
    }

  </style>

</head>
<body onload="timeNow()">
  <div class="assistant" id="assistant" >
  	Hello,You look phenomenal today!
  </div>
  <div id="topbar" class="topbar" >
  </div>
   <div id="graphforHealth" class="graph"></div>
  <div id="a1" class="a1" onclick="healthGraph()" ></div>
  <div class="div1">
    <ul id="myUL">
    </ul>
  </div>
    <div class="app" id="app">
	    <a href="#" onclick="start_selfiecam()" id="start-camera" class="visible">Touch here to start the app.</a>
	    <video id="camera-stream"></video>
	    <img id="snap">
	    <p id="error-message"></p>
	    <!-- Hidden canvas element. Used for taking snapshot of video. -->
	    <canvas></canvas>

    </div>
    <input id="speech" type="text">
    <button id="rec" class="btn">Speak</button>
    <div class="bottombar">Home Assistant with Throwback Tool</div>
</body>
<script>
  var flag=0;
  //setInterval("timeNow()", 1000);
//Initial list setup Code:
    var myNodelist = document.getElementsByTagName("LI");
    var i;
    for (i = 0; i < myNodelist.length; i++) {
      var span = document.createElement("SPAN");
      var txt = document.createTextNode("\u00D7");
      span.className = "close";
      span.appendChild(txt);
      myNodelist[i].appendChild(span);
    }

    // Click on a close button to hide the current list item
    var close = document.getElementsByClassName("close");
    var i;
    for (i = 0; i < close.length; i++) {
      close[i].onclick = function() {
        var div = this.parentElement;
        div.style.display = "none";
      }
    }

    // Add a "checked" symbol when clicking on a list item
    var list = document.querySelector('ul');
    list.addEventListener('click', function(ev) {
      if (ev.target.tagName === 'LI') {
        ev.target.classList.toggle('checked');
      }
    }, false);
// Create a new list item when clicking on the "Add" button
  function newElement(inputValue) {
  	/*
  	Add json file code for to-do list
  	*/

    var li = document.createElement("li");
    var t = document.createTextNode(inputValue);
  	t.tagName=inputValue;
    li.appendChild(t);
    if (inputValue === '') {
      alert("You must write something!");
    } else {
      document.getElementById("myUL").appendChild(li);
    }

    var span = document.createElement("SPAN");
    var txt = document.createTextNode("\u00D7");
    span.className = "close";
    span.appendChild(txt);
    li.appendChild(span);

    for (i = 0; i < close.length; i++) {
      close[i].onclick = function() {
        var div = this.parentElement;
        div.style.display = "none";
      }
    }
  }
//Time Greeting Method:
  function timeNow() {
    var d = new Date(),
        h = (d.getHours()<10?'0':'') + d.getHours(),
        m = (d.getMinutes()<10?'0':'') + d.getMinutes(),
        s = (d.getSeconds()<10?'0':'') + d.getSeconds();;
        i=h+":"+m+":"+s;
        document.getElementById("topbar").innerHTML=i;
    if(h>=12 && h<16)
      document.getElementById("a1").innerHTML="good afternoon";
    else if(h>=16 && h<22)
      document.getElementById("a1").innerHTML="good evening";
    else if(h>=22 && h<24)
      document.getElementById("a1").innerHTML="good night";
    else
      document.getElementById("a1").innerHTML="good morning";;
      }

// Voice Assistant Method: api.ai
var accessToken = "e4922dc44e874cbd839e38a2ff4b53bb",
      baseUrl = "https://api.api.ai/v1/",
      $speechInput,
      $recBtn,
      recognition,
      messageRecording = "Recording...",
      messageCouldntHear = "I couldn't hear you, could you say that again?",
      messageInternalError = "Oh no, there has been an internal server error",
      messageSorry = "I'm sorry, I don't have the answer to that yet.";

    $(document).ready(function() {
      console.log("hey");
      $speechInput = $("#speech");
      $recBtn = $("#rec");

      $speechInput.keypress(function(event) {
        if (event.which == 13) {
          event.preventDefault();
          send();
        }
      });
      $recBtn.on("click", function(event) {
        switchRecognition();
      });
      $(".debug__btn").on("click", function() {
        $(this).next().toggleClass("is-active");
        return false;
      });
      startRecognition();
    });

    function startRecognition() {
      recognition = new webkitSpeechRecognition();
      recognition.continuous = true;
          recognition.interimResults = false;
          recognition.start();
        respond(messageRecording);
        updateRec();
      recognition.onresult = function(event) {
        recognition.onend = null;
        
        var text = "";
          for (var i = event.resultIndex; i < event.results.length; ++i) {
            text += event.results[i][0].transcript;
          }
          setInput(text);
       // stopRecognition();
      };
      recognition.onend = function() {
        respond(messageCouldntHear);
        //stopRecognition();
      };
      recognition.lang = "en-US";
      //recognition.start();
    }
  
    function stopRecognition() {
      if (recognition) {
        recognition.stop();
        recognition = null;
      }
      updateRec();
    }

    function switchRecognition() {
      if (recognition) {
        stopRecognition();
      } else {
        startRecognition();
      }
    }

    function setInput(text) {
      $speechInput.val(text);
      send();
    }

    function updateRec() {
      $recBtn.text(recognition ? "Stop" : "Speak");
    }

    function send() {
      var text = $speechInput.val();
      $.ajax({
        type: "POST",
        url: baseUrl + "query",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        headers: {
          "Authorization": "Bearer " + accessToken
        },
        data: JSON.stringify({query: text, lang: "en", sessionId: "rahul"}),

        success: function(data) {
          prepareResponse(data);
        },
        error: function() {
          respond(messageInternalError);
        }
      });
    }

    function prepareResponse(val) {
      var debugJSON = JSON.stringify(val, undefined, 2),
        spokenResponse = val.result.speech;

      respond(spokenResponse);
      debugRespond(debugJSON);
    }

    function debugRespond(val) {
      $("#response").text(val);
    }

    function respond(val) {
      if (val == "") {
        val = messageSorry;
      }

            //overlaoding value
      $("#assistant").html((val.split("_"))[1]);
      temp_val=val;
      val=val.split("_");
      console.log(val[1]);
      if(val[1])
      {
        if(val[0]=="task")
        {
          //task function
          document.getElementById("assistant").innerHTML='Task Added';
          newElement(val[1]);
        }
        if(val[0]=="check")
        {
          //check function
          var ul = document.getElementById("myUL");
              var items = ul.getElementsByTagName("li");
              for (var i = 0; i < items.length; ++i) 
              {
                var filter=val[1].toUpperCase();
                 //add function to remove from json
                if (items[i].innerHTML.toUpperCase().indexOf(filter) > -1)
                {
                  var div = items[i];
                  div.style.display = "none";
                  document.getElementById("assistant").innerHTML="Slashed Out!";
                }
                else
                {
                  document.getElementById("assistant").innerHTML="You never had such tasks";
                }
              }
        }
        //New Condition
        if(val[0]=="selfie")
        { 
          //camera
          start_selfiecam();
        }
        if(val[0]=="click")
        { 
          //camera
          take_photo();
        }
        if(val[0]=="closecam")
        {
          hideVideo();
        }
        if(val[0]=="health")
        {
          healthGraph();  
        }

      }
      else
      {
        document.getElementById("assistant").innerHTML=temp_val;
        var msg = new SpeechSynthesisUtterance();
        msg.voiceURI = "native";
        msg.text = temp_val;
        msg.lang = "en-US";
       // window.speechSynthesis.speak(msg);
        //startRecognition();
      }

    }
</script>
<script src="assets/js/script.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-database.js"></script>
<script>
  // Initialize Firebase
 var config = {
    apiKey: "AIzaSyB3FS9x4nqs8FdvbLzTmOSQcRXG5Jwcq5E",
    authDomain: "hawtt-4313f.firebaseapp.com",
    databaseURL: "https://hawtt-4313f.firebaseio.com",
    projectId: "hawtt-4313f",
    storageBucket: "hawtt-4313f.appspot.com",
    messagingSenderId: "439526547125"
  };
  firebase.initializeApp(config);
  // Get a reference to the database service
</script>
 <script src="plotlysource.js"></script>
<script>
  // Script for Health Graph.
  function healthGraph()
  { console.log("healthGraph clicked");
    var database = firebase.database();
    var currentUserLocal = firebase.database().ref('currentUser');
    var healthDate = new Array();
    var vital1= new Array();
    var vital2= new Array();
    var vital3= new Array();
    currentUserLocal.once('value').then(function(snapshot) 
    {
      a=snapshot.val();
      console.log(a);
      var healthStatus=firebase.database().ref('Health/' + a);
        healthStatus.once('value', function(snapshot2)
        { console.log("hey");
          snapshot2.forEach(function(childSnapshot) 
          { console.log("hey");
            var childKey = childSnapshot.key;
            var childData = childSnapshot.val();
            console.log(childData);
            cD=String(childData).split("_");
            healthDate.push(childKey);
            vital1.push(cD[0]);
            vital2.push(cD[1]);
            vital3.push(cD[2]);
            console.log(vital1+" "+vital2 + " " + vital3 + " "+ healthDate);
          });
          visualize(healthDate,vital1,vital2,vital3);
        });
    });
  }
  function visualize(h,v1,v2,v3)
  {
    //console.log(h+v);
    vital = document.getElementById('graphforHealth');

    Plotly.plot( vital, [{
    x: h,
    y: v1,
    name: 'Vital 1',
    marker: {color: 'rgb(26, 118, 255)'},
    type: 'hover' }], { 
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0)',
    margin: { t: 0 } }
 );
    Plotly.plot( vital, [{
    x: h,
    y: v2,
    name: 'Vital 2',
    marker: {color: 'rgb(55, 83, 109)'},
    type: 'hover'  }], { 
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0)',
    margin: { t: 0 }});
    Plotly.plot( vital, [{
    x: h,
    y: v3,
    name: 'Vital 3',
    marker: {color: 'rgb(26, 118, 255)'},
    type: 'hover'  }], { 
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0)',
    margin: { t: 0 } });


/* Current Plotly.js version */
console.log( Plotly.BUILD );
  }
</script>
</html>
